using System;
using System.Collections.Generic;
using SixLabors.ImageSharp.PixelFormats;
using System.Globalization;

namespace ii.AscendancyLib
{
    public class DefaultPalette
    {
        // Palette taken from game.pal
        public static List<String> defaultPalette = new List<String>()
        {
            "000000",
            "030303",
            "070707",
            "0C0C0C",
            "101010",
            "141414",
            "181818",
            "1D1D1D",
            "212121",
            "252525",
            "292929",
            "2E2E2E",
            "323232",
            "363636",
            "3A3A3A",
            "3F3F3F",
            "00150A",
            "001C0E",
            "002311",
            "002A14",
            "120A13",
            "190D1B",
            "201123",
            "27142B",
            "291901",
            "312409",
            "382F10",
            "3F3A18",
            "2E1016",
            "32171D",
            "361F24",
            "3B262B",
            "100E0A",
            "15120C",
            "1A160F",
            "1E1A11",
            "050E17",
            "061321",
            "08182A",
            "091D33",
            "1D0C01",
            "271201",
            "301801",
            "3A1E01",
            "0E0215",
            "160B20",
            "1E152A",
            "271E34",
            "060C0A",
            "090E0F",
            "0A1011",
            "0C1314",
            "0E1516",
            "0F1718",
            "111A1B",
            "131C1D",
            "151F1F",
            "162122",
            "182424",
            "1A2626",
            "1B2829",
            "1D2B2B",
            "1F2D2D",
            "213030",
            "140400",
            "180906",
            "1D0F0C",
            "221512",
            "271B18",
            "2C211E",
            "302624",
            "352C2A",
            "1C1209",
            "211810",
            "261E16",
            "2B231C",
            "302922",
            "352E28",
            "3A342E",
            "3F3934",
            "16060E",
            "210810",
            "2E090E",
            "370F0D",
            "3A2018",
            "3D2E23",
            "3F392F",
            "3F3F3C",
            "3F2900",
            "3F3306",
            "3F3D0D",
            "3D3F13",
            "3C1B00",
            "3F2102",
            "3F2808",
            "3F2D0E",
            "000C17",
            "051723",
            "09222F",
            "0D2D3A",
            "0F323F",
            "1A363F",
            "253B3F",
            "2F3F3F",
            "000514",
            "060C1B",
            "0C1422",
            "111B28",
            "141F2B",
            "1A2632",
            "1F2E39",
            "25353F",
            "120000",
            "180000",
            "1E0000",
            "230000",
            "260100",
            "2F0B04",
            "371508",
            "3F1E0C",
            "3F240F",
            "3F2D18",
            "3F3620",
            "3E3F28",
            "3E3F2A",
            "3F3F30",
            "3F3F36",
            "3F3F3C",
            "3F2C18",
            "3C2A17",
            "3A2816",
            "372615",
            "342414",
            "322313",
            "2F2112",
            "2C1F11",
            "2A1D0F",
            "271B0E",
            "24190D",
            "22170C",
            "1F150B",
            "1C140A",
            "1A1209",
            "171008",
            "343F02",
            "1D3902",
            "0B3003",
            "042909",
            "042112",
            "041A15",
            "041113",
            "03090C",
            "3F001D",
            "36031C",
            "2D071A",
            "240B18",
            "1B0E17",
            "121215",
            "091613",
            "001911",
            "373615",
            "333117",
            "33300F",
            "2E2B14",
            "2F2B1C",
            "2A321B",
            "262B18",
            "272B10",
            "202E13",
            "1D2E1D",
            "242C21",
            "22251C",
            "1B2620",
            "1F1E22",
            "1D181D",
            "15161E",
            "161616",
            "121711",
            "121C18",
            "0D1E12",
            "132414",
            "171F0F",
            "1A1C16",
            "201E11",
            "252414",
            "1B2417",
            "1D2009",
            "141A09",
            "121503",
            "0B1102",
            "061606",
            "0D160A",
            "080F0A",
            "040E11",
            "040716",
            "0A0710",
            "03070C",
            "0A0508",
            "0F0A04",
            "050B03",
            "030304",
            "0F0D0E",
            "130F15",
            "0B0C17",
            "050D1D",
            "061521",
            "0E131B",
            "11091D",
            "0C0C24",
            "131026",
            "0E1729",
            "16192A",
            "1D1C2E",
            "1A2128",
            "2D260D",
            "2C100C",
            "330E10",
            "230912",
            "3F0000",
            "06233F",
            "0E273F",
            "162B3F",
            "1A2D3F",
            "1E2F3F",
            "1F3F00",
            "132C12",
            "28361D",
            "23313F",
            "3F2B2C",
            "3F2729",
            "3F2325",
            "3F1A1D",
            "3F1215",
            "3F0A0E",
            "3F003F",
            "2F2337",
            "332939",
            "2B1C33",
            "383338",
            "0C321C",
            "041815",
            "041815",
            "03080C",
            "3F3F3F",
            "3F3F00",
            "313020",
            "100D04",
            "362A16",
            "141106",
            "0E0C04",
            "163F39",
            "142832",
            "102129",
            "0A3F1C",
            "0B2923",
            "00003F"
        };

        public static Rgba32 GetColour(string hexColor)
        {
            if (string.IsNullOrEmpty(hexColor))
                return new Rgba32(0, 0, 0);

            if (hexColor.StartsWith("#"))
                hexColor = hexColor.Substring(1);

            if (hexColor.Length != 6)
                return new Rgba32(0, 0, 0);

            // Colours from game.pal are too dark, we need to brighten them to get them to match the in-game values
            const int BrightnessMultiplier = 4;

            var red = int.Parse(hexColor.Substring(0, 2), NumberStyles.HexNumber) * BrightnessMultiplier;
            var green = int.Parse(hexColor.Substring(2, 2), NumberStyles.HexNumber) * BrightnessMultiplier;
            var blue = int.Parse(hexColor.Substring(4, 2), NumberStyles.HexNumber) * BrightnessMultiplier;

            return new Rgba32(
                (byte)Math.Min(255, red),
                (byte)Math.Min(255, green),
                (byte)Math.Min(255, blue)
            );
        }
    }
}